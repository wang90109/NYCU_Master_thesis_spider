# NYCU 論文資料庫爬蟲與分析工具

這是一個用於爬取和分析國立陽明交通大學論文資料庫的自動化工具。具備完整的教授論文分析功能，專注於碩士生學術表現統計。

## 主要功能

### 🎯 核心功能
1. **學院爬取** - 從 NYCU 首頁爬取所有學院連結（college_crawler.py）
2. **系所爬取** - 爬取各學院下的系所資訊，支援分頁（department_crawler.py）
3. **系所瀏覽** - 瀏覽各學院系所（自動載入部門資料）
4. **教授搜尋** - 智慧搜尋指導教授（支援中文名稱過濾）
5. **論文分析** - 深度分析教授指導的碩士論文
6. **學生統計** - 詳細學生修業年限分析
7. **關鍵詞分析** - 研究領域與指導教授統計

### 📊 分析功能
- **修業年限計算** - 基於學號自動計算入學到畢業時間
- **平均修業年限** - 統計該教授學生的平均修業時間
- **關鍵詞分類** - 自動分離研究關鍵詞與指導教授姓名
- **資料過濾** - 只統計4年內完成的正常修業學生
- **智慧識別** - 自動識別碩士生學號（3開頭9位數）

## 技術需求

### 必要環境
1. **Python 3.8+** - 建議使用 Python 3.9 或以上版本
2. **Chrome 瀏覽器** - 最新版本
3. **ChromeDriver** - 自動管理（無需手動安裝）

### Python 套件
- `selenium` - 網頁自動化
- `webdriver-manager` - 自動管理 ChromeDriver
- `json` - 資料處理（內建套件）
- `datetime` - 時間計算（內建套件）

## 專案結構

```
thesis_analyzer/
├── main.py                          # 主程式 - 論文分析工具
├── college_crawler.py               # 學院爬蟲 - 爬取學院資訊
├── department_crawler.py            # 系所爬蟲 - 爬取系所資訊  
├── college_links.json               # 學院資料（由 college_crawler.py 產生）
├── departments.json                 # 系所資料（由 department_crawler.py 產生）
├── main_backup.py                   # 原始主程式備份
├── src/                            # 模組化程式碼
│   ├── __init__.py                 # 套件初始化
│   ├── config.py                   # 配置與常量
│   ├── data_loader.py              # 資料載入模組
│   ├── web_scraper.py              # 網頁爬取模組
│   ├── paper_analyzer.py           # 論文分析模組
│   ├── statistics.py               # 統計分析模組
│   └── utils.py                    # 工具函數模組
├── README.md                        # 專案說明
└── requirements.txt                 # 依賴套件
```

### 🏗️ 模組化架構

程式已重構為模組化結構，各功能分離到獨立模組中：

- **config.py** - 所有配置參數和常量
- **data_loader.py** - JSON 資料載入、系所編碼處理
- **web_scraper.py** - Selenium 網頁爬取功能
- **paper_analyzer.py** - 論文詳細資訊分析
- **statistics.py** - 統計計算和結果顯示
- **utils.py** - 修業年限計算等工具函數

## 安裝與使用

### 快速開始

1. **克隆專案**：
```bash
git clone https://github.com/wang90109/thesis_analyzer.git
cd thesis_analyzer
```

2. **安裝依賴**：
```bash
pip install -r requirements.txt
# 或手動安裝
pip install selenium webdriver-manager
```

3. **按順序執行程式**：

#### Step 1: 爬取學院資料
```bash
python college_crawler.py
```
此步驟會從 NYCU 首頁爬取所有學院資訊，產生 `college_links.json` 檔案。

#### Step 2: 爬取系所資料
```bash
python department_crawler.py
```
此步驟會讀取 `college_links.json`，爬取每個學院的系所資訊，產生 `departments.json` 檔案。

#### Step 3: 執行論文分析
```bash
python main.py
```
此步驟會使用系所資料進行教授論文分析。

### 使用流程

1. **選擇系所** - 程式會顯示所有學院和系所編碼（如 A-1、B-2）
2. **自動掃描** - 系統自動爬取該系所所有教授列表
3. **搜尋教授** - 輸入教授姓名（支援部分名稱搜尋）
4. **分析論文** - 自動分析該教授指導的所有碩士論文
5. **查看結果** - 獲得詳細的統計分析報告

### 輸出範例

```
📊 林教授 碩士生詳細資訊:
   碩士生總數: 15 人 (修業年限 ≤ 4年)
================================================================================

1. 論文標題: 基於深度學習的影像識別系統設計與實作
   學號: 313505001
   發表日期: 2024/06/15
   修業年限: 2年9個月
   關鍵詞: 深度學習, 影像識別, 神經網路, 機器學習, 人工智慧
----------------------------------------

📈 統計摘要:
   平均修業年限: 2年8個月
   
   指導教授 (前5位):
     - 林志明 (12次)
     - 王小華 (8次)
   
   研究關鍵詞 (前10個):
     - 深度學習 (8次)
     - 機器學習 (6次)
     - 影像處理 (5次)
```

## 技術特色

### 🏗️ 模組化設計
- **清晰的程式架構** - 各功能模組獨立，易於維護和擴展
- **配置集中管理** - 所有配置參數統一在 config.py 中管理
- **功能模組分離** - 資料載入、網頁爬取、分析統計各自獨立
- **可重用性高** - 各模組可單獨測試和重用

### 🔧 智慧化功能
- **分階段爬取** - 三步驟完整資料收集流程
- **自動分頁處理** - 智慧處理空頁和分頁導航
- **按鈕狀態檢測** - 檢查下一頁按鈕是否可點擊
- **無頭模式運行** - 可在背景執行，不受視窗狀態影響
- **錯誤恢復** - 強健的錯誤處理和重試機制
- **中文名稱過濾** - 自動識別和過濾中文教授姓名

### 📋 資料處理
- **學號解析** - 自動解析民國學年度和入學時間
- **修業年限計算** - 精確計算從入學到畢業的時間
- **關鍵詞清理** - 過濾標點符號和無關詞彙
- **未來日期處理** - 自動調整鎖定發表的論文日期

### 🎯 分析精度
- **只統計正常修業** - 過濾超過4年的異常案例
- **有效資料驗證** - 確保學號和發表日期完整
- **平均值計算** - 精確的統計分析
- **分類統計** - 分離指導教授和研究關鍵詞

## 注意事項與限制

### ⚠️ 使用限制
1. **網路連線** - 需要穩定的網際網路連線
2. **存取頻率** - 請適度使用，避免對伺服器造成負擔
3. **資料範圍** - 目前僅支援碩士論文分析
4. **學號格式** - 僅處理3開頭的9位數學號（碩士生）

### 🔒 合規使用
- 請遵守學校網站的使用條款
- 僅供學術研究和統計分析使用
- 請勿用於商業目的
- 尊重個人隱私和資料保護

## 疑難排解

### 常見問題

**Q: 程式執行順序是什麼？**
A: 必須按照順序執行：1) college_crawler.py → 2) department_crawler.py → 3) main.py

**Q: 程式無法找到教授？**
A: 確認系所選擇正確，且已完成前兩步驟的資料爬取。

**Q: college_links.json 檔案不存在？**
A: 請先執行 college_crawler.py 來產生學院資料檔案。

**Q: departments.json 檔案不存在？**
A: 請先執行 department_crawler.py 來產生系所資料檔案。

**Q: 修業年限計算錯誤？**
A: 檢查學號格式是否為9位數且以3開頭，程式僅處理標準格式。

**Q: Chrome 瀏覽器相關錯誤？**
A: 更新Chrome到最新版本，程式會自動管理ChromeDriver。

**Q: 分析速度較慢？**
A: 這是正常現象，程式需要逐頁分析每篇論文的詳細資訊。

**Q: 想要修改爬取參數怎麼辦？**
A: 可以修改 `src/config.py` 檔案中的相關配置，如最大頁數、等待時間等。

**Q: 如何單獨測試某個功能模組？**
A: 可以單獨導入模組進行測試，例如：`from src.data_loader import load_departments`

## 開發資訊

### 版本歷史
- **v1.0** - 基礎爬蟲功能
- **v2.0** - 加入學生資訊分析
- **v3.0** - 完整統計分析與關鍵詞處理
- **v3.1** - 修業年限過濾和程式架構優化
- **v4.0** - 分階段爬取架構，支援學院和系所分別爬取
- **v5.0** - 模組化重構，提升程式可讀性與可維護性

### 技術架構
- **程式架構**: 模組化設計，功能分離
- **前端**: Selenium WebDriver
- **後端**: Python 資料處理
- **資料格式**: JSON
- **瀏覽器**: Chrome Headless Mode

## 授權與貢獻

### 📄 授權條款
MIT License - 詳見 LICENSE 檔案

### 🤝 貢獻指南
歡迎提出 Issue 或 Pull Request 來改善此專案：

1. Fork 此專案
2. 建立功能分支 (`git checkout -b feature/新功能`)
3. 提交變更 (`git commit -am '加入新功能'`)
4. 推送到分支 (`git push origin feature/新功能`)
5. 建立 Pull Request

### 📧 聯絡資訊
如有問題或建議，請透過 GitHub Issues 聯絡。

---
*最後更新：2025年7月22日*
